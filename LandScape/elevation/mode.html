
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Learn Technical Words - Stages</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background-color: #f0f8ff;
      position: relative;
    }
    .card {
      background-color: #ffffff;
      border: 2px solid #000;
      border-radius: 10px;
      width: 300px;
      margin: 20px auto;
      padding: 20px;
      box-shadow: 2px 2px 10px rgba(0,0,0,0.1);
    }
    button {
      padding: 10px;
      font-size: 1.1em;
      margin: 10px;
      cursor: pointer;
      width: 200px;
      border-radius: 5px;
      border: 2px solid #000;
      background-color: #eee;
    }
    .options {
      display: grid;
      grid-template-columns: 1fr 1fr;
      grid-gap: 10px;
      justify-items: center;
      margin-top: 20px;
    }
    .result {
      margin-top: 20px;
      font-size: 1.5em;
    }
    .stage-info {
      font-size: 1.2em;
      margin-bottom: 20px;
    }
    .conquered-words {
      position: absolute;
      top: 10px;
      right: 10px;
      text-align: right;
      max-width: 180px;
      font-size: 0.9em;
      background-color: #f0f8ff;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 5px;
      box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.1);
    }
    .conquered-title {
      font-weight: bold;
    }
    .start-indicator {
      color: #32cd32;
      font-size: 1.2em;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>

  <div class="stage-info" id="stageInfo">Stage: 1</div>

  <div class="start-indicator" id="startIndicator">Game Starting!</div>

  <div class="card" id="card" onclick="playEnglish()">
    <div id="englishWord">Press Start</div>
  </div>

  <button id="startButton" onclick="startGame()">Press Start</button>
  <button onclick="nextWord()">Next Word</button>

  <div class="options">
    <button onclick="checkAnswer(0)" id="option0"></button>
    <button onclick="checkAnswer(1)" id="option1"></button>
    <button onclick="checkAnswer(2)" id="option2"></button>
    <button onclick="checkAnswer(3)" id="option3"></button>
  </div>

  <div class="result" id="result"></div>

  <div class="conquered-words" id="conqueredWords">
    <div class="conquered-title">Conquered Words:</div>
    <div id="conqueredList">None</div>
  </div>

  <script>
    let words = [
    { english: 'dawn', hebrew: 'שחר' }
   // { english: '', hebrew: '' }
    
];

    let currentWordIndex = 0;
    let correctAnswerIndex = 0;
    let currentStage = 1;
    let wordsInStage = [];
    let attempts = {};
    let conqueredWords = [];
    let gameStarted = false;

    function shuffleArray(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    // Shuffle words array when the page loads
    window.onload = function () {
      words = shuffleArray(words);
    };

    function updateStageInfo() {
      document.getElementById('stageInfo').textContent = `Stage: ${currentStage}`;
      speakFeedback(`You are now in stage ${currentStage}`);
    }

    function updateConqueredList() {
      const conqueredList = document.getElementById('conqueredList');
      if (conqueredWords.length > 0) {
        conqueredList.innerHTML = conqueredWords.join('<br>');
      } else {
        conqueredList.innerHTML = "None";  // Show 'None' if no conquered words
      }
    }

    function nextStage() {
      currentStage++;
      wordsInStage = shuffleArray(words.slice(0, currentStage * 5));  // Shuffle the words for the new stage
      attempts = {};  // Reset attempts for each stage
      updateStageInfo();  // Update stage info
      nextWord();
    }

    function nextWord() {
      if (wordsInStage.length === 0) {
        wordsInStage = shuffleArray(words.slice(0, currentStage * 5));  // Shuffle on word reset
      }

      // Randomly pick a word from the stage
      currentWordIndex = Math.floor(Math.random() * wordsInStage.length);
      const currentWord = wordsInStage[currentWordIndex];

      // Show the randomly chosen English word
      document.getElementById('englishWord').textContent = currentWord.english;

      // Play the English word's pronunciation
      playEnglish();

      // Get 3 random wrong options
      let options = words.filter(word => word.english !== currentWord.english).map(word => word.hebrew);
      options = shuffleArray(options).slice(0, 3);

      // Add the correct answer to options
      options.push(currentWord.hebrew);

      // Shuffle the options
      options = shuffleArray(options);

      // Set the correctAnswerIndex
      correctAnswerIndex = options.indexOf(currentWord.hebrew);

      // Show the options
      for (let i = 0; i < 4; i++) {
        document.getElementById(`option${i}`).textContent = options[i];
      }

      // Clear result text
      document.getElementById('result').textContent = '';
    }

    function startGame() {
      document.getElementById('startIndicator').textContent = '';
      gameStarted = true;
      document.getElementById('startButton').textContent = 'Start Over'; // Change button text to Start Over
      document.getElementById('startButton').onclick = resetGame; // Set new function to reset the game
      currentStage = 1;  // Ensure stages reset
      wordsInStage = shuffleArray(words.slice(0, currentStage * 5)); // Shuffle at the start
      nextWord();
    }

    function resetGame() {
      currentStage = 1;
      conqueredWords = [];
      updateStageInfo();
      updateConqueredList();
      document.getElementById('startButton').textContent = 'Press Start'; // Reset the button text
      document.getElementById('startButton').onclick = startGame; // Reset the start function
      gameStarted = false;
      wordsInStage = shuffleArray(words.slice(0, 5));  // Shuffle words on reset
      nextWord();
    }

    function checkAnswer(selectedOption) {
      const currentWord = wordsInStage[currentWordIndex];
      if (!attempts[currentWord.english]) {
        attempts[currentWord.english] = 0;
      }

      if (selectedOption === correctAnswerIndex) {
        document.getElementById('result').textContent = 'Correct!';
        speakFeedback('Correct!');
        
        // Add the conquered word only if not already present
        if (!conqueredWords.includes(currentWord.english)) {
          conqueredWords.push(currentWord.english);
        }
        updateConqueredList();

        wordsInStage = wordsInStage.filter((_, index) => index !== currentWordIndex);

        // Move to the next stage if all words are guessed correctly
        if (wordsInStage.length === 0) {
          if (currentStage === 10) {
            document.getElementById('result').textContent = 'You completed all stages!';
            speakFeedback('You completed all stages!');
          } else {
            nextStage();
          }
        } else {
          nextWord();
        }
      } else {
        attempts[currentWord.english]++;
        if (attempts[currentWord.english] >= 2) {
          document.getElementById('result').textContent = 'Game Over! Try again.';
          speakFeedback('Game Over! Try again.');
          resetGame(); // Reset the game on game over
        } else {
          document.getElementById('result').textContent = 'Try again!';
          speakFeedback('Try again!');
        }
      }
    }

    function playEnglish() {
      const currentWord = wordsInStage[currentWordIndex];
      let utterance = new SpeechSynthesisUtterance(currentWord.english);
      utterance.lang = 'en-US';
      window.speechSynthesis.speak(utterance);
    }

    function speakFeedback(text) {
      let utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = 'en-US';
      window.speechSynthesis.speak(utterance);
    }

    // Shuffle words array and start the game with Stage 1 (5 words)
    words = shuffleArray(words);
    wordsInStage = shuffleArray(words.slice(0, 5));
    updateStageInfo();
    updateConqueredList();
  </script>

</body>
</html>
